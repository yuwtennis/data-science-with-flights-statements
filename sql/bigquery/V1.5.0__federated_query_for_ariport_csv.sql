DROP EXTERNAL  TABLE IF EXISTS dsongcp.airports_gcs;

CREATE EXTERNAL TABLE `dsongcp.airports_gcs`(
    AIRPORT_SEQ_ID INTEGER,
    AIRPORT_ID STRING,
    AIRPORT STRING,
    DISPLAY_AIRPORT_NAME STRING,
    DISPLAY_AIRPORT_CITY_NAME_FULL STRING,
    AIRPORT_WAC_SEQ_ID2 STRING,
    AIRPORT_WAC STRING,
    AIRPORT_COUNTRY_NAME STRING,
    AIRPORT_COUNTRY_CODE_ISO STRING,
    AIRPORT_STATE_NAME STRING,
    AIRPORT_STATE_CODE STRING,
    AIRPORT_STATE_FIPS STRING,
    CITY_MARKET_SEQ_ID INTEGER,
    CITY_MARKET_ID INTEGER,
    DISPLAY_CITY_MARKET_NAME_FULL STRING,
    CITY_MARKET_WAC_SEQ_ID2 INTEGER,
    CITY_MARKET_WAC INTEGER,
    LAT_DEGREES INTEGER,
    LAT_HEMISPHERE STRING,
    LAT_MINUTES INTEGER,
    LAT_SECONDS INTEGER,
    LATITUDE FLOAT64,
    LON_DEGREES INTEGER,
    LON_HEMISPHERE STRING,
    LON_MINUTES INTEGER,
    LON_SECONDS INTEGER,
    LONGITUDE FLOAT64,
    UTC_LOCAL_TIME_VARIATION STRING,
    AIRPORT_START_DATE DATE,
    AIRPORT_THRU_DATE STRING,
    AIRPORT_IS_CLOSED INTEGER,
    AIRPORT_IS_LATEST INTEGER
) OPTIONS (
       format = 'CSV',
       quote = '"',
       uris = ['gs://data-science-on-gcp/edition2/raw/airports.csv'],
       skip_leading_rows = 1,
       allow_jagged_rows = false,
       allow_quoted_newlines = false,
       encoding = 'UTF-8',
       field_delimiter = ',',
       ignore_unknown_values = true);